% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/vacant_core.R
\name{vacant_core}
\alias{vacant_core}
\title{Core VACANT Analysis Engine}
\usage{
vacant_core(
  geno,
  score,
  phenotype,
  covariates = NULL,
  test = c("multi", "uni"),
  acat.weight = c("score", "equal"),
  size.threshold = 10,
  transform.method = c("none", "raw_squared", "phred_to_chisq", "log", "sigmoid")
)
}
\arguments{
\item{geno}{Character vector. One string per variant; each character
in the string is one sample's allele count (0/1/2).}

\item{score}{Numeric matrix or vector. Annotation scores; rows = variants.}

\item{phenotype}{Data frame or numeric vector. Binary phenotype (0/1).
If a data frame, must contain a column named \code{phenotype}.}

\item{covariates}{Numeric matrix or data frame. Covariates (default: NULL).}

\item{test}{Character. \code{"multi"} (joint multivariate Firth; default)
or \code{"uni"} (sequential univariate + ACAT).}

\item{acat.weight}{Character. ACAT weighting: \code{"score"} (default)
or \code{"equal"}.}

\item{size.threshold}{Integer. Minimum cluster size for K-means (default: 10).}

\item{transform.method}{Character. Score transformation applied before
clustering: \code{"none"} (default), \code{"raw_squared"},
\code{"phred_to_chisq"}, \code{"log"}, or \code{"sigmoid"}.}
}
\value{
A named list with three elements:
\describe{
\item{\code{results}}{Named numeric vector of p-values and effect estimates.}
\item{\code{model}}{Pareto staircase prediction model (for use with
\code{predict_vacant_cluster()}).}
\item{\code{info}}{List of metadata (test type, weights, n variants, transform).}
}
Returns NULL if no carriers are found or the model fails.
}
\description{
Runs the VACANT statistical analysis on pre-processed R objects.
This is the internal engine called by \code{vacant()}. Advanced users
may call this directly when genotype and score data are already loaded
into memory as R objects.
}
\seealso{
\code{\link{vacant}}, \code{\link{predict_vacant_cluster}}
}
