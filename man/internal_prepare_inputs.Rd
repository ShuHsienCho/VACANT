% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/vacant_helpers.R
\name{internal_prepare_inputs}
\alias{internal_prepare_inputs}
\title{Prepare VACANT Inputs from an XPAT Matrix Block}
\usage{
internal_prepare_inputs(
  sub.matrix,
  col.names,
  ped.dt,
  cov.dt = NULL,
  score.dt,
  score.cols = NULL,
  maf.threshold = 0.01,
  meta.ncols = 11L
)
}
\arguments{
\item{sub.matrix}{Data frame. Rows = variants for one gene; column layout
follows XPAT 2.0: cols 1-\code{meta.ncols} are metadata, col
\code{meta.ncols + 1} is the concatenated genotype string.}

\item{col.names}{Character vector. Full column names from the matrix header
(length = \code{meta.ncols} + n_samples). Used to recover sample IDs.}

\item{ped.dt}{Data frame. Phenotype table with lowercase column names
(\code{iid}, \code{aff} required). PLINK 1/2 coding (1 = control,
2 = case) is recoded to 0/1 automatically.}

\item{cov.dt}{Data frame or NULL. Covariate table; col 1 = IID,
cols 2+ = numeric covariates (PCs, age, etc.).}

\item{score.dt}{Data frame. Annotation score table; cols 1-8 are genomic
coordinate metadata (matching the matrix), cols 9+ are scores.}

\item{score.cols}{Character vector or NULL. Names to assign to score columns
(col 9+ of \code{score.dt}). \code{NULL} uses a single column named
\code{"score"}.}

\item{maf.threshold}{Numeric. Upper MAF bound; variants with MAF >=
\code{maf.threshold} or MAF == 0 are excluded \link{default 0.01}.}

\item{meta.ncols}{Integer. Number of metadata columns before the genotype
string column in the XPAT matrix \link{default 11}.}
}
\value{
A named list. On success: \code{status = "success"} plus
\code{geno} (character vector), \code{score} (data frame),
\code{phenotype} (data frame), \code{covariates} (data frame or NULL).
On failure: \code{status = "fail"} plus \code{message}.
}
\description{
Takes a single-gene subset of an XPAT 2.0 genotype matrix (already loaded
in memory) and prepares all inputs required by \code{vacant_core()}.
Handles sample alignment, phenotype recoding, covariate subsetting,
score joining, genotype string extraction, and MAF filtering.
}
